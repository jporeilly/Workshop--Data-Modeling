<?xml version="1.0" encoding="UTF-8"?>
<Schema name="ClassicModels" 
  caption="%{classicmodels.schema.caption}"
  description="%{classicmodels.schema.description}">
  
  <!-- Sales Cube -->
  <Cube name="Sales" caption="%{classicmodels.measures.sales.caption}" cache="true" enabled="true">
    <Table name="orderdetails"/>
    
    <!-- Customers Dimension -->
    <Dimension name="Customers" 
      foreignKey="orderNumber"
      caption="%{classicmodels.dimension.customers.caption}"
      description="%{classicmodels.dimension.customers.description}">
      
      <Hierarchy name="Customers"
        hasAll="true"
        allMemberName="All Customers"
        primaryKey="customerNumber"
        caption="%{classicmodels.hierarchy.customers.caption}"
        description="%{classicmodels.hierarchy.customers.description}">
        
        <Table name="orders"/>
        <Join leftKey="customerNumber" rightKey="customerNumber">
          <Table name="customers"/>
        </Join>
        
        <Level name="Territory" 
          column="territory" 
          uniqueMembers="true"
          caption="%{classicmodels.dimension.customers.territory.caption}"
          description="%{classicmodels.dimension.customers.territory.description}"/>
        
        <Level name="CustomerName" 
          column="customerName" 
          uniqueMembers="true"
          caption="%{classicmodels.dimension.customers.customername.caption}"
          description="%{classicmodels.dimension.customers.customername.description}"/>
      </Hierarchy>
    </Dimension>
    
    <!-- Products Dimension -->
    <Dimension name="Products" 
      foreignKey="productCode"
      caption="%{classicmodels.dimension.products.caption}"
      description="%{classicmodels.dimension.products.description}">
      
      <Hierarchy name="Products"
        hasAll="true"
        allMemberName="All Products"
        primaryKey="productCode"
        caption="%{classicmodels.hierarchy.products.caption}"
        description="%{classicmodels.hierarchy.products.description}">
        
        <Table name="products"/>
        
        <Level name="ProductLine" 
          column="productLine" 
          uniqueMembers="true"
          caption="%{classicmodels.dimension.products.line.caption}"
          description="%{classicmodels.dimension.products.line.description}"/>
        
        <Level name="ProductVendor" 
          column="productVendor" 
          uniqueMembers="false"
          caption="%{classicmodels.dimension.products.vendor.caption}"
          description="%{classicmodels.dimension.products.vendor.description}"/>
      </Hierarchy>
    </Dimension>
    
    <!-- Measures -->
    <Measure name="QuantityOrdered" 
      column="quantityOrdered" 
      aggregator="sum" 
      formatString="#,###"/>
    
    <Measure name="PriceEach" 
      column="priceEach" 
      aggregator="avg" 
      formatString="$#,##0.00"/>
    
    <Measure name="Sales" 
      column="quantityOrdered"
      aggregator="sum"
      formatString="$#,##0.00">
      <CalculatedMemberProperty name="FORMULA" value="[Measures].[QuantityOrdered] * [Measures].[PriceEach]"/>
    </Measure>
    
    <Measure name="OrderCount" 
      column="orderNumber" 
      aggregator="distinct-count" 
      formatString="#,###"/>
  </Cube>
  
</Schema>